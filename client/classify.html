<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classify Transaction - Petty Cash System</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="/css/styles.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50 min-h-screen">
<!-- Navigation (Locked - No Links) -->
<nav class="bg-white shadow-sm border-b border-gray-200">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex justify-between h-16"><div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fas fa-hospital text-blue-600 text-2xl mr-3"></i>
                        <h1 class="text-xl font-bold text-gray-900">Transaction Classification</h1>
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="px-3 py-2 rounded-md text-sm font-medium bg-yellow-100 text-yellow-800">
                        <i class="fas fa-lock mr-1"></i> System Locked
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <!-- System Lock Warning -->
    <div class="bg-yellow-50 border-b border-yellow-200">
        <div class="max-w-7xl mx-auto px-4 py-3 sm:px-6 lg:px-8">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-triangle text-yellow-400 text-xl"></i>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-yellow-800">
                        System Locked for Classification
                    </h3>
                    <p class="mt-1 text-sm text-yellow-700">
                        You must complete this transaction classification before accessing other parts of the system.
                        All other functions are disabled until classification is complete.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- Main Content -->
    <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        <!-- Transaction Summary -->
        <div class="mb-8 bg-white shadow rounded-lg overflow-hidden">
            <div class="px-4 py-5 sm:px-6 bg-blue-50 border-b border-blue-100">
                <h3 class="text-lg leading-6 font-medium text-gray-900">
                    Transaction Details </h3>
                <p class="mt-1 max-w-2xl text-sm text-gray-600">
                    M-Pesa transaction requiring classification
                </p>
            </div>
            <div class="border-t border-gray-200">
                <dl>
                    <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                        <dt class="text-sm font-medium text-gray-500">
                            Transaction ID
                        </dt>
                        <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 font-mono" id="transaction-id">
                            -
                        </dd>
                    </div>
                    <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                        <dt class="text-sm font-medium text-gray-500">
                            Date & Time
                        </dt>
                        <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2" id="transaction-date">
                            -
                        </dd>
                    </div>
                    <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                        <dt class="text-sm font-medium text-gray-500">
                            Previous Balance
                        </dt>
                        <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                            Ksh <span id="prev-balance">0.00</span>
                        </dd>
                    </div>
                    <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                        <dt class="text-sm font-medium text-gray-500">
                            New Balance
                        </dt>
                        <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                            Ksh <span id="new-balance">0.00</span>
                        </dd>
                    </div>
                    <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"><dt class="text-sm font-medium text-gray-500">
                            Change (Delta)
                        </dt>
                        <dd class="mt-1 text-sm font-gray-900 sm:mt-0 sm:col-span-2">
                            <span id="delta" class="font-bold">Ksh 0.00</span>
                            <span id="delta-type" class="ml-2 px-2 py-1 text-xs rounded-full"></span>
                        </dd>
                    </div>
                    <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
                        <dt class="text-sm font-medium text-gray-500">
                            M-Pesa Fee (Auto-classified)
                        </dt>
                        <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                            <i class="fas fa-robot text-blue-500 mr-1"></i>
                            Ksh <span id="mpesa-fee" class="font-mono">0.00</span>
                            <span class="ml-2 text-xs text-gray-500">(System category: M-Pesa Fees)</span>
                        </dd>
                    </div>
                </dl>
            </div>
        </div>
        <!-- Classification Section -->
        <div class="mb-8 bg-white shadow rounded-lg overflow-hidden">
            <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <div>
                        <h3 class="text-lg leading-6 font-medium text-gray-900">
                            Category Allocation
                        </h3>
                        <p class="mt-1 max-w-2xl text-sm text-gray-500">
                            Split the remaining amount into appropriate categories
                        </p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="text-right">
                            <div class="text-sm text-gray-500">Remaining to allocate</div>
                            <div class="text-2xl font-bold" id="remaining-amount">Ksh 0.00</div>
                        </div>
                        <div id="balance-status" class="px-3 py-1 rounded-full text-sm font-medium">
                            <!-- Filled by JavaScript --></div>
</div>
</div>
</div>
<div class="px-4 py-5 sm:p-6">
<!-- Split Rows Container -->
<div id="split-rows" class="space-y-4 mb-6">
<!-- Split rows will be added here by JavaScript -->
<div class="text-center py-8 text-gray-500">
<i class="fas fa-plus-circle text-3xl mb-2"></i>
<p>Click "Add Category" to start classifying</p>
</div>
</div>
<!-- Controls -->
<div class="flex flex-wrap gap-3 mb-6">
<button id="btn-add-category" 
class="inline-flex items-center px-4 py-2 border border-t
ransparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-b
lue-700">
<i class="fas fa-plus mr-2"></i>
Add Category
</button>
<button id="btn-clear-all" 
class="inline-flex items-center px-4 py-2 border border-g
ray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
<i class="fas fa-trash-alt mr-2"></i>
Clear All
</button>
<button id="btn-auto-split" 
class="inline-flex items-center px-4 py-2 border border-g
ray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
<i class="fas fa-magic mr-2"></i>
Suggest Split
</button>
</div>
<!-- Validation Summary -->
<div id="validation-summary" class="hidden p-4 rounded-lg mb-6">
<!-- Filled by JavaScript -->
</div>
<!-- Action Buttons -->
<div class="flex justify-end space-x-4 pt-6 border-t border-gray-20
0">
<button id="btn-cancel" class="px-4 py-2 border border-gray-300 text-sm font-medi
um rounded-md text-gray-700 bg-white hover:bg-gray-50">
<i class="fas fa-times mr-2"></i>
Cancel (Emergency)
</button>
<button id="btn-save-splits" 
class="px-4 py-2 border border-transparent text-sm font-m
edium rounded-md text-white bg-gray-400"
disabled>
<i class="fas fa-save mr-2"></i>
Save Classification
</button>
<button id="btn-lock-transaction" 
class="px-4 py-2 border border-transparent text-sm font-m
edium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700"
disabled>
<i class="fas fa-lock mr-2"></i>
Lock Transaction
</button>
</div>
</div>
</div>
<!-- Auto-classified Items (Read-only) -->
<div class="bg-white shadow rounded-lg overflow-hidden">
<div class="px-4 py-5 sm:px-6 border-b border-gray-200">
<h3 class="text-lg leading-6 font-medium text-gray-900">
Auto-classified Items
</h3>
<p class="mt-1 max-w-2xl text-sm text-gray-500">
System-generated classifications (cannot be modified)
</p>
</div>
<div class="px-4 py-5 sm:p-6">
<div class="overflow-x-auto">
<table class="min-w-full divide-y divide-gray-200">
<thead>
<tr>
<th class="px-3 py-3 text-left text-xs font-medium te
xt-gray-500 uppercase tracking-wider">
Category
</th>
<th class="px-3 py-3 text-left text-xs font-medium te
xt-gray-500 uppercase tracking-wider">
Amount
</th>
<th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
Description
</th>
<th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
Type
</th>
</tr>
</thead>
<tbody id="auto-classified-body" class="divide-y divide-gray-200">
<tr>
<td colspan="4" class="px-3 py-4 text-center text-gray-500"></td>
No auto-classified items
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</main>
<!-- Cancel Modal -->
<div id="cancel-modal" class="modal hidden">
<div class="modal-content max-w-md">
<div class="modal-header">
<h3 class="text-lg font-medium text-gray-900">
<i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>
Emergency System Unlock
</h3>
<button type="button" class="modal-close">
<i class="fas fa-times"></i>
</button>
</div>
<div class="modal-body">
<div class="space-y-4">
<div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
<div class="flex">
<div class="ml-3">
<p class="text-sm text-yellow-700">
<strong>Warning:</strong> This will delete the op
en transaction and unlock the system.
This action should only be used in emergencies.
</p></div>
</div>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">
Reason for Emergency Unlock
</label>
<textarea class="input-field h-24" 
id="cancel-reason"
placeholder="Explain why you need to cancel this tr
ansaction..."></textarea>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-2">
Admin Code
</label>
<input type="password" 
class="input-field"
id="admin-code"
placeholder="Enter admin code">
</div>
</div>
</div>
<div class="modal-footer">
<button type="button" class="btn-secondary modal-close">
Go Back
</button>
<button type="button" id="btn-confirm-cancel" 
class="btn-danger">
<i class="fas fa-unlock mr-2"></i>
Force Unlock System
</button>
</div>
</div>
</div>
<script src="js/api.js"></script>
<script src="js/classify.js"></script>
</body>
</html>